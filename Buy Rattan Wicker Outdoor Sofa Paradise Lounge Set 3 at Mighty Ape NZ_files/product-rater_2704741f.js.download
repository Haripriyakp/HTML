MA.productRater={};MA.productRater.init=function(options){$('.rater').each(function(i,productRater){var $productRater=$(productRater);$productRater.find('.rating label').each(function(i,label){var $label=$(label);var rating=$label.find('input').val();$label.on({click:function(){if($('body').hasClass('logged-in')){$.ajax({url:$productRater.data('ajaxAction'),dataType:'json',type:'POST',data:{rating:rating},success:function(data){var $ratingList=$productRater.find('.rating');$ratingList.attr('data-stars',parseInt(rating,10).toFixed(1));$productRater.addClass('rated');$label.tooltip('hide');if(options&&options.successHandler){options.successHandler();}},error:function(xhr,ajaxOptions,thrownError){if(xhr.status=='401'){MA.notices.add('You need to be logged in to rate products.');}else{MA.notices.add('An error occurred when rating this product. Please try again.');}}});}else{MA.notices.add('You need to be logged in to rate products.');}}});});});};