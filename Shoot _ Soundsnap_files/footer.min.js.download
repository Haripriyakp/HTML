if("undefined"!=typeof wavesurfer){var loaded=[],ua=navigator.userAgent.toLowerCase(),msie=ua.indexOf("trident"),msedge=ua.indexOf("edge"),safari=ua.indexOf("safari"),chrome=ua.indexOf("chrome"),seconds=[],promised_data=[],playbar=function(e,t){"use strict";0===t?jQuery(".jp-play-bar").width(e+"%"):jQuery(".jp-play-bar").stop().animate({width:e+"%"},t,"linear")};function loadingWave(e,t){"use strict";"loading"===t?(jQuery(".wave-loader:eq("+e+")").html("loading"),jQuery(".wave > wave:eq("+e+")").css({opacity:.2})):(jQuery(".wave-loader:eq("+e+")").empty(),jQuery(".wave > wave:eq("+e+")").css({opacity:1}))}function playbarProcess(e,t){"use strict";e>0&&(playbar(100*(e/t),80),jQuery(".jp-current-time").html(convertTime(e)))}function convertTime(e){"use strict";e=e&&"number"==typeof e?e:0;var t=new Date(1e3*e),i=t.getUTCHours(),s=t.getUTCMinutes()+60*i,a=t.getUTCSeconds(),o="";return o+=(s<10?"0"+s:s)+":",o+=(a<10?"0"+a:a)+""}function getPeaks(e){return $j.ajax({url:e,type:"get",dataType:"JSON"}).promise()}function changeVolume(e){"use strict";jQuery.each(wavesurfer,function(t){wavesurfer[t].setVolume(e)})}"true"==readCookie("ss_autoplay")&&(jQuery(".jp-autoplay").addClass("on"),jQuery(".jp-autoplay").attr("title","disable autoplay")),jQuery(".jp-autoplay").click(function(){jQuery(this).toggleClass("on"),jQuery(this).hasClass("on")?(createCookie("ss_autoplay","true",7),jQuery(this).attr("title","disable autoplay")):(createCookie("ss_autoplay","false",7),jQuery(this).attr("title","enable autoplay"))});var volume="0.8";function load_media(e){if(void 0!==wavesurfer[e]&&void 0!==wavesurfer[e].backend.song){var t=wavesurfer[e].backend.peaks;t.includes("http")?(promised_data[e]=getPeaks(t),promised_data[e].done(function(t){wavesurfer[e].backend.peaks=t,wavesurfer[e].load(wavesurfer[e].backend.song,wavesurfer[e].backend.peaks,"auto")})):wavesurfer[e].load(wavesurfer[e].backend.song,wavesurfer[e].backend.peaks,"auto"),loaded[e]=!0,console.log("load: "+startTimer(e))}else loadingWave(e,"loading")}readCookie("ss_volume")&&(volume=readCookie("ss_volume")),createCookie("ss_volume",volume,7),jQuery(".jp-pause").hide(),jQuery(".jp-volume-bar-value").width(100*volume+"%"),jQuery(".jp-volume-bar").on("click",function(e){var t=jQuery(this).offset(),i=(e.pageX-t.left)/jQuery(this).width(),s=Math.ceil(10*i)/10;jQuery(".jp-volume-bar-value").width(100*s+"%"),jQuery(".jp-unmute").hide(),jQuery(".jp-mute").show(),createCookie("ss_volume",s,7),changeVolume(s)}),jQuery(".jp-seek-bar").on("click",function(e){var t=jQuery(this).offset(),i=(e.pageX-t.left)/jQuery(this).width(),s=0;jQuery.each(jQuery(".ojoo-button"),function(e){jQuery(this).hasClass("active")&&(s=e)}),wavesurfer[s].getCurrentTime()>0&&(playbar(100*i,0),wavesurfer[s].seekTo(i))}),volume>0?jQuery(".jp-unmute").hide():jQuery(".jp-mute").hide(),jQuery(".jp-mute").on("click",function(){jQuery(".jp-unmute").show(),jQuery(".jp-mute").hide(),changeVolume(0),jQuery(".jp-volume-bar-value").width("0%")}),jQuery(".jp-unmute").on("click",function(){jQuery(".jp-unmute").hide(),jQuery(".jp-mute").show(),changeVolume(volume),jQuery(".jp-volume-bar-value").width(100*volume+"%")}),jQuery(".jp-play").on("click",function(){var e=0;jQuery.each(jQuery(".ojoo-button"),function(t){jQuery(this).hasClass("active")&&(e=t)}),jQuery(".ojoo-button:eq("+e+")").trigger("click")}),jQuery(".jp-pause").on("click",function(){jQuery(".ojoo-button.active").trigger("click")}),jQuery(".jp-next").on("click",function(){var e=1;jQuery.each(jQuery(".ojoo-button"),function(t){jQuery(this).hasClass("active")&&(e=t+1)}),jQuery(".ojoo-button:eq("+e+")").trigger("click")}),jQuery(".jp-previous").on("click",function(){var e=0;jQuery.each(jQuery(".ojoo-button"),function(t){jQuery(this).hasClass("active")&&(e=t-1)}),e>=0&&jQuery(".ojoo-button:eq("+e+")").trigger("click")}),jQuery.each(wavesurfer,function(e){var t,i=e+1;jQuery("audio:eq("+e+")"),wavesurfer[e].params.backend;(wavesurfer[e].setVolume(volume),null==(t=wavesurfer[e].backend.peaks)||safari>0&&chrome<0)?load_media(e):(t=wavesurfer[e].backend.peaks).includes("http")?(promised_data[e]=getPeaks(t),promised_data[e].done(function(t){wavesurfer[e].backend.peaks=t,wavesurfer[e].drawBuffer(),wavesurfer[e].createPeakCache()})):(wavesurfer[e].drawBuffer(),wavesurfer[e].createPeakCache());wavesurfer[e].on("waveform-ready",function(){loadingWave(e,"stop"),loaded[e]=!0}),wavesurfer[e].on("ready",function(){wavesurfer[e].setVolume(volume),loadingWave(e,"stop"),loaded[e]||(loaded[e]=!0),console.log("ready: "+startTimer(e))}),wavesurfer[e].on("seek",function(){var t=wavesurfer[e].getDuration();playbarProcess(wavesurfer[e].getCurrentTime(),t),console.log("seek (previous): "+startTimer(e))}),wavesurfer[e].on("play",function(){if(console.log("play: "+startTimer(e)),jQuery(".ojoo-button:eq("+e+")").hasClass("active")){var t=wavesurfer[e].getDuration();jQuery(".jp-progress").addClass("jp-active"),jQuery(".jp-duration").html(convertTime(t)),jQuery(".ojoo-audio-box:not(:eq("+e+")).active").removeClass("active"),jQuery(".ojoo-audio-box:eq("+e+")").addClass("active")}else wavesurfer[e].stop(),console.log("stop: "+startTimer(e));wavesurfer[e].isPlaying()&&console.log("playing: "+startTimer(e)),jQuery(".jp-seek-bar").show(),(!0===loaded[e]||msie>0)&&loadingWave(e,"stop")}),wavesurfer[e].on("audioprocess",function(){var t=wavesurfer[e].getDuration(),i=wavesurfer[e].getCurrentTime();playbarProcess(i,t),i>0&&(loadingWave(e,"stop"),loaded[e]=!0)}),wavesurfer[e].on("finish",function(){playbar(0,1),jQuery(".jp-progress").removeClass("jp-active"),jQuery(".jp-duration").empty(),jQuery(".jp-current-time").empty(),jQuery(".jp-play").show(),jQuery(".jp-pause").hide(),wavesurfer[e].stop(),wavesurfer[e].toggleInteraction(),jQuery(".ojoo-button").removeClass("ojoo-pause"),jQuery(".ojoo-audio-box:eq("+e+")").removeClass("active"),jQuery(".jp-title-content").empty(),wavesurfer[i]&&(jQuery(".jp-autoplay").hasClass("on")&&jQuery(".ojoo-button:eq("+i+")").trigger("click"),jQuery(".ojoo-button:eq("+i+")").addClass("active"))}),wavesurfer[e].on("error",function(){wavesurfer[e].destroy(),jQuery(".ojoo-audio:eq("+e+")").addClass("ojoo-error"),jQuery(".ojoo-button:eq("+e+")").off().removeClass("ojoo-play"),jQuery(".wave:eq("+e+")").html("There was an error loading the file")}),jQuery(window).resize(function(){wavesurfer[e].empty(),wavesurfer[e].drawBuffer()})}),jQuery("body").keydown(function(e){jQuery("#edit-keys-ojoo").is(":focus")||(37==e.keyCode?jQuery(".jp-previous").trigger("click"):39==e.keyCode&&jQuery(".jp-next").trigger("click"))}),jQuery(".ojoo-button").on("mouseover",function(){var e=jQuery(".ojoo-button").index(this);console.log("--"+e+" hover: "+startTimer(e,!0)),loaded[e]||load_media(e)}),jQuery(".jp-next").on("mouseover",function(){var e=1;jQuery.each(jQuery(".ojoo-button"),function(t){jQuery(this).hasClass("active")&&(e=t+1)}),loaded[e]||load_media(e)}),jQuery(".jp-previous").on("mouseover",function(){var e=0;jQuery.each(jQuery(".ojoo-button"),function(t){jQuery(this).hasClass("active")&&(e=t-1)}),e>=0&&(loaded[e]||load_media(e))}),jQuery(".ojoo-button").on("click",function(){var e=jQuery(this);e.hasClass("active")||(playbar(0,0),e.addClass("active"));var t=jQuery(".ojoo-button").index(this);jQuery.each(jQuery(".ojoo-button"),function(e){e!==t||wavesurfer[e].params.interact||wavesurfer[e].toggleInteraction(),e!==t&&((jQuery(this).hasClass("active")||jQuery(this).hasClass("ojoo-pause")||wavesurfer[e].params.interact)&&(wavesurfer[e].stop(),loadingWave(e,"stop")),jQuery(this).hasClass("ojoo-pause")&&jQuery(this).removeClass("ojoo-pause"),wavesurfer[e].params.interact&&wavesurfer[e].toggleInteraction(),jQuery(this).removeClass("active"))}),e.hasClass("ojoo-pause")?(e.removeClass("ojoo-pause"),wavesurfer[t].pause(),jQuery(".jp-play").show(),jQuery(".jp-pause").hide()):(e.addClass("ojoo-pause"),jQuery(".jp-play").hide(),jQuery(".jp-pause").show(),jQuery(".jp-seek-bar").hide(),loaded[t]||load_media(t),wavesurfer[t].play())}),jQuery(".jp-controls a").on("touchstart",function(){jQuery(this).removeClass("touch-out").addClass("touch-in")}),jQuery(".jp-controls a").on("touchend",function(){jQuery(this).removeClass("touch-in").addClass("touch-out")})}function startTimer(e,t){return t&&(seconds[e]=0,clearInterval(timer)),timer=setInterval(function(){seconds[e]++},1),seconds[e]}function clickToCopy(e,t){jQuery(document).on("click","#"+e,function(e){e.preventDefault()});var i=document.getElementById(t);i.select(),i.setSelectionRange(0,99999),document.execCommand("copy"),document.getElementById(e).innerHTML="Copied!"}var $nid,timer,path="";function fav_loader(e,t){var i=$j("#throbber-"+e);"show"===t&&(i.show(),$j("#fav-container-"+e).removeClass("active"),$j("#fav-container-"+e+">.favorite_message").empty()),"hide"===t&&i.hide(),"over-show"===t&&(i.show(),$j(".favorites_groups").css({opacity:"0.3"})),"over-hide"===t&&(i.hide(),$j(".favorites_groups").css({opacity:"1"}))}function confirm_dialog(e){$j("body").append("<div id='TB_overlay'></div><div id='TB_window' class='TB-dialog'></div>"),$j("#TB_window").append("<div id='TB_title'><div id='TB_ajaxWindowTitle'><h2 class='title'>Favorites</h2></div><div id='TB_closeAjaxWindow'><a href='#' id='TB_closeWindowButton' title='Close'>close</a></div></div>"),$j("#TB_window").append("<div id='TB_ajaxContent'>"+e.message+"</div>"),$j("#TB_ajaxContent").append("<div><a href='"+e.url+"' class='form-submit "+e.class+"'>"+e.button+"</a></div>");var t=($j(window).width()-$j("#TB_window").width())/2/$j(window).width(),i=($j(window).height()-2*$j("#TB_window").height())/2/$j(window).height();$j("#TB_window").css({left:100*t+"%",top:100*i+"%"}),$j("#TB_window").show()}if($j(document).on("submit",".favorites_groups form",function(e){e.preventDefault();var t=$j(this).parents(".fav-container").attr("data-nid");$j("#fav-container-"+t+" .fav-group-add-button").trigger("click")}),$j(document).on("click",".fav-group-add-button",function(){var e=$j(this).parents(".fav-container").attr("data-nid"),t=$j("#title-fav-group-"+e).val(),i="title="+t,s=$j("#fav-container-"+e).html();if(t.length>0){fav_loader(e,"show");var a=new XMLHttpRequest;a.open("GET",path+"/favorites_group/add/"+e+"?ajax=true&"+i,!0),a.onreadystatechange=function(){200===a.status?($j("#fav-container-"+e).html(a.responseText),fav_loader(e,"hide")):($j("#fav-container-"+e).html(s+a.responseText),fav_loader(e,"hide"))},a.send(),$j(".si_favorite").addClass("update_needed")}return!1}),$j(document).on("click",".favorites_groups > li > a.fav-add",function(){var e=$j(this).parents(".fav-container").attr("data-nid"),t=$j(this).attr("data-gid");if(void 0===t);else{fav_loader(e,"show");var i=new XMLHttpRequest;i.open("GET",path+"/favorite_nodes/add/"+e+"/"+t+"?ajax=true",!0),i.onreadystatechange=function(){200===i.status&&($j("#fav-container-"+e).html(i.responseText),fav_loader(e,"hide"))},i.send()}return!1}),$j(document).on("click",".si_favorite",function(e){$nid=$j(this).parent(".fav-container").attr("data-nid");var t=$j(this);if(!t.hasClass("si_public"))if(e.preventDefault(),t.hasClass("si_active"))confirm_dialog({url:$j(this).attr("href"),class:"confirm-delete",message:"Are you sure you want to remove<br> the sound from your favorites?",button:"Remove"});else if($j("#fav-container-"+$nid).addClass("active"),t.hasClass("update_needed")){fav_loader($nid,"over-show");var i=new XMLHttpRequest;i.open("GET",path+"/favorites_group/check_update/"+$nid+"?ajax=true",!0),i.onreadystatechange=function(){200==i.status&&""!=i.responseText&&($j("#fav-container-"+$nid+" .favorites_groups").html(i.responseText),fav_loader($nid,"over-hide"))},i.send(),t.removeClass("update_needed")}}),$j(function(){$j(document).on("click",".confirm-delete",function(e){e.preventDefault(),fav_loader($nid,"show");var t=new XMLHttpRequest;t.open("GET",path+"/favorite_nodes/delete/"+$nid+"?ajax=true",!0),t.onreadystatechange=function(){200===t.status&&(window.location.href.indexOf("favorites")>-1&&$j("#node-"+$nid).stop().animate({opacity:"0"},800).slideUp(),$j("#fav-container-"+$nid).html(t.responseText),fav_loader($nid,"hide"))},t.send()})}),$j(document).on("click",".js-share-privacy-status a.fav-privacy-status-button",function(e){e.preventDefault(),$url=$j(this).attr("href"),$j(".js-share-privacy-status").addClass("throbber_loader_black");var t=new XMLHttpRequest;return t.open("GET",path+$url+"?ajax=true",!0),t.onreadystatechange=function(){200===t.status&&($j(".js-share-privacy-status").html(t.responseText).removeClass("throbber_loader_black"),$j(".js-share-content").toggleClass("private shared"))},t.send(),!1}),$j(document).on("mouseenter",".fav-container",function(){clearTimeout(timer)}),$j(document).on("mouseleave",".fav-container",function(){clearTimeout(timer),$div=$j(this),timer=setTimeout(function(){$div.removeClass("active")},2e3)}),$j(document).on("click","body",function(e){!$j(e.target).closest(".fav-container").length&&$j(".fav-container").hasClass("active")&&$j(".fav-container").removeClass("active"),$j(e.target).closest(".favorites_toolbar").length||0!=$j(".fav-group-openadd-button:visible").length||($j(".fav-group-add-form").hide(),$j(".fav-group-openadd-button").show()),$j(e.target).closest(".favorites_toolbar").length||0!=$j(".fav-group-title:visible").length||($j(".fav-group-edit-form").hide(),$j(".fav-group-title").show())}),$j(document).on("click",".fav-group-delete-button",function(e){e.preventDefault(),confirm_dialog({url:$j(this).attr("href"),class:"",message:"Are you sure you want to delete this list?",button:"Delete"})}),$j(document).on("click",".fav-group-privacy-button",function(e){e.preventDefault(),confirm_dialog({url:$j(this).attr("href"),class:"",message:"Are you sure you want to change<br>the privacy settings of this list?",button:"Change"})}),$j(document).on("click","#TB_closeWindowButton",function(e){e.preventDefault(),$j("#TB_overlay").remove(),$j("#TB_window").remove()}),$j(document).on("click",".TB-dialog #TB_ajaxContent .form-submit",function(){$j("#TB_overlay").remove(),$j("#TB_window").remove()}),"a"==dynamic_data.keywordSuggestType.source){var currentInput="";function keyword_suggest_autocompleteAutoAttach(){var e=[],t=document.getElementsByTagName("input");for(i=0;input=t[i];i++)input&&hasClass(input,"keyword-suggest-autocomplete")&&(uri=input.value,e[uri]||(e[uri]=new keyword_suggest_ACDB(uri)),input=$(input.id.substr(0,input.id.length-13)),input.setAttribute("autocomplete","OFF"),new keyword_suggest_jsAC(input,e[uri]))}function keyword_suggest_autocompleteSubmit(){var e=document.getElementById("autocomplete");return!e||(e.owner.hidePopup(),!1)}function keyword_suggest_jsAC(e,t){var i=this;this.input=e,this.db=t,this.input.onkeydown=function(e){return i.onkeydown(this,e)},this.input.onkeyup=function(e){i.onkeyup(this,e)},this.input.onblur=function(){i.hidePopup(),i.db.cancel()},this.popup=document.createElement("div"),this.popup.id="autocomplete",this.popup.owner=this}function keyword_suggest_ACDB(e){this.uri=e,this.delay=300,this.cache={}}let e=searchClient.initIndex(searchIndex);isJsEnabled()&&addLoadEvent(keyword_suggest_autocompleteAutoAttach),keyword_suggest_jsAC.prototype.hidePopup=function(e){this.selected&&(e&&46!=e&&8!=e&&27!=e||!e)&&(this.input.value=this.selected.autocompleteValue),this.popup.parentNode&&this.popup.parentNode.tagName&&removeNode(this.popup),this.selected=!1},keyword_suggest_jsAC.prototype.onkeydown=function(t,i){switch(i||(i=window.event),removeClass(t,"invalid"),i.keyCode){case 40:return this.selectDown(),!1;case 38:return this.selectUp(),!1;case 13:return this.submitFlag=!0,t.value.length>0?this.timer=setTimeout(function(){e.search(document.getElementById("edit-keys-ojoo-suggest-query").value,{attributesToRetrieve:["_tags","objectID","nbHits","audio_playTime","uid","created","categories"],hitsPerPage:15,facets:"*"}).then(({hits:e,nbHits:t,query:i})=>{results=[],nidMain=[],nids=[];for(var s=0;s<e.length;s++)void 0!==e[s]._highlightResult&&(nidMain.push(e[s].objectID),nids.push(e[s]));document.getElementById("edit-keys-ojoo-nids").value=nidMain,document.getElementById("edit-keys-ojoo-hits").value=t,document.getElementById("edit-keys-ojoo-full").value=JSON.stringify(nids),document.getElementById("edit-keys-ojoo-suggest-query").value=i,document.getElementById("ojoo_search_audio_only").submit()})},200):addClass(t,"invalid"),!1;default:return!0}},keyword_suggest_jsAC.prototype.onkeyup=function(e,t){switch(t||(t=window.event),t.keyCode){case 16:case 17:case 18:case 20:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:return!0;case 9:case 13:case 27:return this.hidePopup(t.keyCode),!0;default:return e.value.length>0?this.populatePopup():this.hidePopup(t.keyCode),!0}},keyword_suggest_jsAC.prototype.select=function(t){this.input.value=t.autocompleteValue;this.input.form;var i=t.autocompleteValue;e.search(i,{attributesToRetrieve:["_tags","objectID","nbHits","audio_playTime","uid","created","categories"],hitsPerPage:15,facets:"*"}).then(({hits:e,nbHits:t,query:i})=>{results=[],nidMain=[],nids=[];for(var s=0;s<e.length;s++)void 0!==e[s]._highlightResult&&(nidMain.push(e[s].objectID),nids.push(e[s]));document.getElementById("edit-keys-ojoo-nids").value=nidMain,document.getElementById("edit-keys-ojoo-hits").value=t,document.getElementById("edit-keys-ojoo-full").value=JSON.stringify(nids),document.getElementById("edit-keys-ojoo-suggest-query").value=i,document.getElementById("ojoo_search_audio_only").submit()})},keyword_suggest_jsAC.prototype.selectDown=function(){if(this.selected&&this.selected.nextSibling)this.highlight(this.selected.nextSibling);else{var e=this.popup.getElementsByTagName("li");e.length>0&&this.highlight(e[0])}},keyword_suggest_jsAC.prototype.selectUp=function(){this.selected&&this.selected.previousSibling&&this.highlight(this.selected.previousSibling)},keyword_suggest_jsAC.prototype.highlight=function(e){removeClass(this.selected,"selected"),addClass(e,"selected"),this.selected=e},keyword_suggest_jsAC.prototype.unhighlight=function(e){removeClass(e,"selected"),this.selected=!1},keyword_suggest_jsAC.prototype.populatePopup=function(){var e=absolutePosition(this.input);currentInput=this.input.value,this.selected=!1,this.popup.style.top=e.y+this.input.offsetHeight+"px",this.popup.style.left=e.x+"px",this.popup.style.width=this.input.offsetWidth-4+"px",this.db.owner=this,this.db.search(this.input.value)},keyword_suggest_jsAC.prototype.found=function(e){for(;this.popup.hasChildNodes();)this.popup.removeChild(this.popup.childNodes[0]);this.popup.parentNode&&this.popup.parentNode.tagName||document.getElementsByTagName("body")[0].appendChild(this.popup);var t=document.createElement("ul");for(key in s=this,e){var i=document.createElement("li"),a=document.createElement("div");a.innerHTML=e[key],i.appendChild(a),i.autocompleteValue=key,i.onmousedown=function(){s.select(this)},i.onmouseover=function(){s.highlight(this)},i.onmouseout=function(){s.unhighlight(this)},t.appendChild(i)}t.childNodes.length>0?this.popup.appendChild(t):this.hidePopup(),removeClass(this.input,"throbbing")},keyword_suggest_ACDB.prototype.search=function(t){var i;this.timer&&clearTimeout(this.timer),localStorage.setItem("searchTerm",t);var s=t;e.search(s,{attributesToRetrieve:["_tags","objectID","nbHits","audio_playTime","uid","created","categories"],attributesToHighlight:["_tags"],hitsPerPage:500,facets:"*"}).then(({hits:e,nbHits:s,query:a})=>{i=[],nidMain=[],nids=[],console.log(s);for(var o=0;o<e.length;o++)if(void 0!==e[o]._highlightResult){var r=e[o]._highlightResult._tags;if(nidMain.push(e[o].objectID),nids.push(e[o]),void 0!==r)for(var n=0;n<r.length;n++)"none"!=r[n].matchLevel&&-1===i.indexOf(r[n].value.replace(/(<([^>]+)>)/gi,""))&&(i[r[n].value.replace(/(<([^>]+)>)/gi,"")]=r[n].value.replace(/(<([^>]+)>)/gi,""))}this.timer=setTimeout(function(){const e=document.getElementsByClassName("search-loader");for(;e.length>0;)e[0].remove()},10),currentInput==t&&(document.getElementById("edit-keys-ojoo-nids").value=nidMain,document.getElementById("edit-keys-ojoo-hits").value=s,document.getElementById("edit-keys-ojoo-full").value=JSON.stringify(nids),document.getElementById("edit-keys-ojoo-suggest-query").value=a,this.owner.found(i))})},keyword_suggest_ACDB.prototype.receive=function(e){},keyword_suggest_ACDB.prototype.cancel=function(){this.owner&&removeClass(this.owner.input,"throbbing"),this.timer&&clearTimeout(this.timer),this.transport&&(this.transport.onreadystatechange=function(){},this.transport.abort())}}if(jQuery.fn.extend({initModalOptions:function(){jQuery.modal.defaults.fadeDuration=50,jQuery(window).on(jQuery.modal.BEFORE_OPEN,function(e,t){jQuery.modal.isActive()}),jQuery(".modal-link").on("click",function(e){return jQuery(this).modal({fadeDuration:50}),!1})}}),jQuery(function(){jQuery.fn.initModalOptions()}),jQuery(window).on(jQuery.modal.OPEN,function(e,t){labelAnimation.initlabelAnimation(),initSoundsnap.initCollapse(),labelAnimation.initRequiredFields(),loginTemplate.initLoginTemplate(),checkUser.initCheckUser();var i=window.location.href;jQuery(".modal form#user_login_block, .modal form#user_register").submit(function(e){e.preventDefault();var t=jQuery(this);t.prepend("<div class='spin-loader'></div>");var s=t.serializeArray(),a=JSON.stringify(s);return jQuery.ajax({type:"POST",data:{edit:a},url:"/login_callback",dataType:"html",success:function(e){var t=jQuery.parseJSON(e);t.message?(jQuery(".modal-message").html(t.message),jQuery(".spin-loader").remove()):t.destination?window.location=t.destination:t.action?window.location=t.action:window.location=i},error:function(){}}),!1})}),"v"==dynamic_data.dynamicSearchType.source&&void 0!==dynamic_data.currentPage&&"audio_search"==dynamic_data.currentPage.value)var sliderApp=new Vue({el:"#vue-app",data:{timeOut:null,min:0,max:0,query:"",minValue:0,maxValue:0,step:1,totalSteps:0,percentPerStep:1,trackWidth:null,isDragging:!1,filteredNid:[],audioPlayTimeFilter:"",allFilters:"",dateAddedFilter:"",dateAdded:5,avaialableDates:["3 days ago","7 days ago","1 month ago","3 months ago","6 months ago","All"],selectedDateAddedPeriod:"All",dateAddedMs:0,allNid:[],allTags:[],numberHits:0,maxVisibleTag:0,minVisibleTag:0,filteredTags:[],allCategories:[],maxVisibleCategories:0,minVisibleCategory:0,filteredCategories:[],allUid:[],maxVisibleUid:0,minVisibleUid:0,filteredUid:[],pos:{curTrack:null}},methods:{getNextVisibleTags(){0===this.maxVisibleTag?this.allTags.length>8?this.maxVisibleTag=8:this.maxVisibleTag=this.allTags.length-1:this.maxVisibleTag+1<this.allTags.length?(this.maxVisibleTag++,this.minVisibleTag++):this.minVisibleTag++},getPrevVisibleTags(){this.minVisibleTag>0&&(this.maxVisibleTag--,this.minVisibleTag--)},getNextVisibleCategories(){0===this.maxVisibleCategories?this.allCategories.length>8?this.maxVisibleCategories=8:this.maxVisibleCategories=this.allCategories.length-1:this.maxVisibleCategories+1<this.allCategories.length?(this.maxVisibleCategories++,this.maxVisibleCategories++):this.minVisibleCategory++},getPrevVisibleCategories(){this.minVisibleCategory>0&&(this.maxVisibleCategories--,this.minVisibleCategory--)},getNextVisibleUid(){0===this.maxVisibleUid?this.allUid.length>8?this.maxVisibleUid=8:this.maxVisibleUid=this.allUid.length-1:this.maxVisibleUid+1<this.allUid.length?(this.maxVisibleUid++,this.maxVisibleUid++):this.minVisibleUid++},getPrevVisibleUid(){this.minVisibleUid>0&&(this.maxVisibleUid--,this.minVisibleUid--)},changeDateAdded(){if(this.selectedDateAddedPeriod=this.avaialableDates[this.dateAdded],5===this.dateAdded)this.dateAddedFilter="";else{var e=0;switch(this.dateAdded){case"0":e=3;break;case"1":e=7;break;case"2":e=30;break;case"3":e=90;break;case"4":e=180;break;default:e=0}if(e>0){var t=new Date((new Date).setDate((new Date).getDate()-e)).valueOf();this.dateAddedMs=t}else this.dateAddedMs=0}this.runFilter()},moveTrack(e,t){let i=this.getPercentInPx(),s=Math.round(this.$refs._vpcTrack.getBoundingClientRect().left),a=(t.clientX-s)/i;if(a<1||a>100)return;let o=Math.round(a/this.percentPerStep)*this.step+this.min;if("track1"===e){if(o>=this.maxValue-this.step)return;this.minValue=o}if("track2"===e){if(o<=this.minValue+this.step)return;this.maxValue=o}this.$refs[e].style.left=a+"%",this.setTrackHightlight(),this.runFilter()},sleep:e=>new Promise(t=>setTimeout(t,e)),filterNids(e,t){},runFilter(){let e=searchClient.initIndex(searchIndex);this.audioPlayTimeFilter="audio_playTime:"+this.minValue+" TO "+this.maxValue,this.allFilters=this.audioPlayTimeFilter,this.dateAddedMs>0&&""!==this.allFilters?this.allFilters+=" AND created > "+this.dateAddedMs:this.dateAddedM>0&&""===this.allFilters&&(this.allFilters+="created > "+this.dateAddedMs),this.filteredCategories.length>0&&""!==this.allFilters?this.filteredCategories.forEach(e=>{0===this.filteredCategories.indexOf(e)?this.allFilters+=" AND ":this.allFilters+=" OR ",this.allFilters+="categories:'"+e+"'"}):this.filteredCategories.length>0&&""===this.allFilters&&this.filteredCategories.forEach(e=>{0===this.filteredCategories.indexOf(e)?this.allFilters+=" ":this.allFilters+=" OR ",this.allFilters+="categories:'"+e+"'"}),this.filteredTags.length>0&&""!==this.allFilters?this.filteredTags.forEach(e=>{0===this.filteredTags.indexOf(e)?this.allFilters+=" AND ":this.allFilters+=" OR ",this.allFilters+="_tags:'"+e+"'"}):this.filteredTags.length>0&&""===this.allFilters&&this.filteredTags.forEach(e=>{0===this.filteredTags.indexOf(e)?this.allFilters+=" ":this.allFilters+=" OR ",this.allFilters+="_tags:'"+e+"'"}),this.filteredUid.length>0&&""!==this.allFilters?this.filteredUid.forEach(e=>{0===this.filteredUid.indexOf(e)?this.allFilters+=" AND ":this.allFilters+=" OR ",this.allFilters+="uid:'"+e+"'"}):this.filteredUid.length>0&&""===this.allFilters&&this.filteredUid.forEach(e=>{0===this.filteredUid.indexOf(e)?this.allFilters+=" ":this.allFilters+=" OR ",this.allFilters+="Uid:'"+e+"'"}),currentFilter=this.allFilters,e.search(this.query,{attributesToRetrieve:["_tags","objectID","nbHits","audio_playTime","uid","created","categories"],hitsPerPage:15,facets:"*",filters:currentFilter}).then(({hits:e,nbHits:t,query:i})=>{if(this.allFilters===currentFilter){results=[],nidMain=[],nids=[];for(var s=0;s<e.length;s++)void 0!==e[s]._highlightResult&&(nidMain.push(e[s].objectID),nids.push(e[s]));this.numberHits=t,document.getElementById("edit-keys-ojoo-nids").value=nidMain,document.getElementById("edit-keys-ojoo-hits").value=t,document.getElementById("edit-keys-ojoo-full").value=JSON.stringify(nids),document.getElementById("edit-keys-ojoo-suggest-query").value=i,document.getElementById("edit-keys-ojoo").value=i}})},submitFilter(){let e=searchClient.initIndex(searchIndex);this.audioPlayTimeFilter="audio_playTime:"+this.minValue+" TO "+this.maxValue,this.allFilters=this.audioPlayTimeFilter,this.dateAddedMs>0&&""!==this.allFilters?this.allFilters+=" AND created > "+this.dateAddedMs:this.dateAddedM>0&&""===this.allFilters&&(this.allFilters+="created > "+this.dateAddedMs),this.filteredCategories.length>0&&""!==this.allFilters?this.filteredCategories.forEach(e=>{0===this.filteredCategories.indexOf(e)?this.allFilters+=" AND ":this.allFilters+=" OR ",this.allFilters+="categories:'"+e+"'"}):this.filteredCategories.length>0&&""===this.allFilters&&this.filteredCategories.forEach(e=>{0===this.filteredCategories.indexOf(e)?this.allFilters+=" ":this.allFilters+=" OR ",this.allFilters+="categories:'"+e+"'"}),this.filteredTags.length>0&&""!==this.allFilters?this.filteredTags.forEach(e=>{0===this.filteredTags.indexOf(e)?this.allFilters+=" AND ":this.allFilters+=" OR ",this.allFilters+="_tags:'"+e+"'"}):this.filteredTags.length>0&&""===this.allFilters&&this.filteredTags.forEach(e=>{0===this.filteredTags.indexOf(e)?this.allFilters+=" ":this.allFilters+=" OR ",this.allFilters+="_tags:'"+e+"'"}),this.filteredUid.length>0&&""!==this.allFilters?this.filteredUid.forEach(e=>{0===this.filteredUid.indexOf(e)?this.allFilters+=" AND ":this.allFilters+=" OR ",this.allFilters+="uid:'"+e+"'"}):this.filteredUid.length>0&&""===this.allFilters&&this.filteredUid.forEach(e=>{0===this.filteredUid.indexOf(e)?this.allFilters+=" ":this.allFilters+=" OR ",this.allFilters+="Uid:'"+e+"'"}),e.search(this.query,{attributesToRetrieve:["_tags","objectID","nbHits","audio_playTime","uid","created","categories"],hitsPerPage:15,facets:"*",filters:this.allFilters}).then(({hits:e,nbHits:t,query:i})=>{results=[],nidMain=[],nids=[];for(var s=0;s<e.length;s++)void 0!==e[s]._highlightResult&&(nidMain.push(e[s].objectID),nids.push(e[s]));this.numberHits=t,document.getElementById("edit-keys-ojoo-nids").value=nidMain,document.getElementById("edit-keys-ojoo-hits").value=t,document.getElementById("edit-keys-ojoo-full").value=JSON.stringify(nids),document.getElementById("edit-keys-ojoo-suggest-query").value=i,document.getElementById("edit-keys-ojoo").value=i,document.getElementById("ojoo_search_audio_only").submit()})},clearFilter(){searchClient.initIndex(searchIndex).search(this.query,{attributesToRetrieve:["_tags","objectID","nbHits","audio_playTime","uid","created","categories"],hitsPerPage:15,facets:"*"}).then(({hits:e,nbHits:t,query:i})=>{results=[],nidMain=[],nids=[];for(var s=0;s<e.length;s++)void 0!==e[s]._highlightResult&&(nidMain.push(e[s].objectID),nids.push(e[s]));document.getElementById("edit-keys-ojoo-nids").value=nidMain,document.getElementById("edit-keys-ojoo-hits").value=t,document.getElementById("edit-keys-ojoo-full").value=JSON.stringify(nids),document.getElementById("edit-keys-ojoo-suggest-query").value=i,document.getElementById("edit-keys-ojoo").value=i,document.getElementById("ojoo_search_audio_only").submit()})},mousedown(e,t){this.isDragging||(this.isDragging=!0,this.pos.curTrack=t)},touchstart(e,t){this.mousedown(e,t)},mouseup(e,t){this.isDragging&&(this.isDragging=!1)},touchend(e,t){this.mouseup(e,t)},mousemove(e,t){this.isDragging&&this.moveTrack(t,e)},touchmove(e,t){this.mousemove(e.changedTouches[0],t)},valueToPercent(e){return(e-this.min)/this.step*this.percentPerStep},setTrackHightlight(){this.$refs.trackHighlight.style.left=this.valueToPercent(this.minValue)+"%",this.$refs.trackHighlight.style.width=this.valueToPercent(this.maxValue)-this.valueToPercent(this.minValue)+"%"},getPercentInPx(){return this.$refs._vpcTrack.offsetWidth/this.totalSteps/this.percentPerStep},setClickMove(e){let t=this.$refs.track1.getBoundingClientRect().left,i=this.$refs.track2.getBoundingClientRect().left;e.clientX<t?this.moveTrack("track1",e):e.clientX-t<i-e.clientX?this.moveTrack("track1",e):this.moveTrack("track2",e)},addTagsFilter(e){let t=this.allTags.indexOf(e),i=this.visibleTags.indexOf(e);e.chosen=!e.chosen,this.allTags[t]=e,this.visibleTags[i]=e,this.filteredTags.includes(e.name)?this.filteredTags=this.filteredTags.filter(t=>t!==e.name):this.filteredTags.push(e.name),this.runFilter()},addCategoriesFilter(e){let t=this.allCategories.indexOf(e),i=this.visibleCategories.indexOf(e);e.chosen=!e.chosen,this.allCategories[t]=e,this.visibleCategories[i]=e,this.filteredCategories.includes(e.name)?this.filteredCategories=this.filteredCategories.filter(t=>t!==e.name):this.filteredCategories.push(e.name),this.runFilter()},addUidFilter(e){let t=this.allUid.indexOf(e),i=this.visibleUid.indexOf(e);e.chosen=!e.chosen,this.allUid[t]=e,this.visibleUid[i]=e,this.filteredUid.includes(e.name)?this.filteredUid=this.filteredUid.filter(t=>t!==e.name):this.filteredUid.push(e.name),this.runFilter()}},computed:{visibleTags(){let e=[];for(var t=this.minVisibleTag;t<=this.maxVisibleTag;t++)e.push(this.allTags[t]);return e},visibleCategories(){let e=[];for(var t=this.minVisibleCategory;t<=this.maxVisibleCategories;t++)e.push(this.allCategories[t]);return e},getCatFilterFiller(){return"col-"+(8-this.maxVisibleCategories)},visibleUid(){let e=[];for(var t=this.minVisibleUid;t<=this.maxVisibleUid;t++)e.push(this.allUid[t]);return e},getUidFilterFiller(){return"col-"+(8-this.maxVisibleUid)},getTagFilterFiller(){return"col-"+(8-this.maxVisibleTag)}},mounted(){let e=[],t="",i=[],s=[],a=[];console.log(dynamic_data),"KW"===dynamic_data.searchResults.source?(e=dynamic_data.searchResults.result,t=dynamic_data.searchResults.query,this.numberHits=dynamic_data.searchResults.nbHits):(this.numberHits=dynamic_data.searchResults.result.nbHits,e=dynamic_data.searchResults.result.hits,t=dynamic_data.searchResults.result.query);let o=0;e.forEach(e=>{""!==this.query&&this.query===t||(0===o?(this.min=e.audio_playTime,this.minValue=e.audio_playTime):e.audio_playTime<this.min&&(this.min=e.audio_playTime,this.minValue=e.audio_playTime),e.audio_playTime>this.max&&(this.max=e.audio_playTime,this.maxValue=e.audio_playTime)),s.includes(e.uid)||(s.push(e.uid),this.allUid.push({name:e.uid,chosen:!1,key:this.allUid.length})),e._tags.forEach(e=>{i.includes(e)||(i.push(e),this.allTags.push({name:e,chosen:!1,key:this.allTags.length}))}),e.categories.forEach(e=>{a.includes(e)||(a.push(e),this.allCategories.push({name:e,chosen:!1,key:this.allCategories.length}))}),o++}),this.query=t,this.totalSteps=(this.max-this.min)/this.step,this.getNextVisibleTags(),this.getNextVisibleCategories(),this.percentPerStep=100/this.totalSteps,document.querySelector(".track1").style.left=this.valueToPercent(this.minValue)+"%",document.querySelector(".track2").style.left=this.valueToPercent(this.maxValue)+"%",this.setTrackHightlight();var r=this;["mouseup","mousemove"].forEach(e=>{document.body.addEventListener(e,t=>{r.isDragging&&r.pos.curTrack&&r[e](t,r.pos.curTrack)})}),["mousedown","mouseup","mousemove","touchstart","touchmove","touchend"].forEach(e=>{document.querySelector(".track1").addEventListener(e,t=>{t.stopPropagation(),r[e](t,"track1")}),document.querySelector(".track2").addEventListener(e,t=>{t.stopPropagation(),r[e](t,"track2")})}),document.querySelector(".track").addEventListener("click",function(e){e.stopPropagation(),r.setClickMove(e)}),document.querySelector(".track-highlight").addEventListener("click",function(e){e.stopPropagation(),r.setClickMove(e)})}});
